from collections import defaultdict


# created from getting columns of each DT_{SOURCE}_2024 table
required_columns_lookup = {
    'EXT': [
        'ADJUSTMENT_K',
        'ASSESSMENT_AREA_CODE',
        'BASE_K',
        'BUDGET_ACTIVITY_CODE',
        'BUDGET_ACTIVITY_NAME',
        'BUDGET_SUB_ACTIVITY_CODE',
        'BUDGET_SUB_ACTIVITY_NAME',
        'CAPABILITY_SPONSOR_CODE',
        'END_STRENGTH',
        'EOC_CODE',
        'EXECUTION_MANAGER_CODE',
        'FISCAL_YEAR',
        'LINE_ITEM_CODE',
        'OCO_OTHD_ADJUSTMENT_K',
        'OCO_OTHD_K',
        'OCO_TO_BASE_K',
        'OSD_PROGRAM_ELEMENT_CODE',
        'POM_POSITION_CODE',
        'POM_SPONSOR_CODE',
        'PROGRAM_CODE',
        'PROGRAM_GROUP',
        'RDTE_PROJECT_CODE',
        'RESOURCE_CATEGORY_CODE',
        'RESOURCE_K',
        'SPECIAL_PROJECT_CODE',
        'SUB_ACTIVITY_GROUP_CODE',
        'SUB_ACTIVITY_GROUP_NAME',
        'WORK_YEARS'
    ],
    'ZBT': [
        'ADJUSTMENT_K',
        'ASSESSMENT_AREA_CODE',
        'BASE_K',
        'BUDGET_ACTIVITY_CODE',
        'BUDGET_ACTIVITY_NAME',
        'BUDGET_SUB_ACTIVITY_CODE',
        'BUDGET_SUB_ACTIVITY_NAME',
        'CAPABILITY_SPONSOR_CODE',
        'END_STRENGTH',
        'EOC_CODE',
        'EXECUTION_MANAGER_CODE',
        'FISCAL_YEAR',
        'LINE_ITEM_CODE',
        'OCO_OTHD_ADJUSTMENT_K',
        'OCO_OTHD_K',
        'OCO_TO_BASE_K',
        'OSD_PROGRAM_ELEMENT_CODE',
        'POM_POSITION_CODE',
        'POM_SPONSOR_CODE',
        'PROGRAM_CODE',
        'PROGRAM_GROUP',
        'RDTE_PROJECT_CODE',
        'RESOURCE_CATEGORY_CODE',
        'RESOURCE_K',
        'SPECIAL_PROJECT_CODE',
        'SUB_ACTIVITY_GROUP_CODE',
        'SUB_ACTIVITY_GROUP_NAME',
        'WORK_YEARS'
    ],
    'ISS': [
        'ADJUSTMENT_K',
        'ASSESSMENT_AREA_CODE',
        'BASE_K',
        'BUDGET_ACTIVITY_CODE',
        'BUDGET_ACTIVITY_NAME',
        'BUDGET_SUB_ACTIVITY_CODE',
        'BUDGET_SUB_ACTIVITY_NAME',
        'CAPABILITY_SPONSOR_CODE',
        'END_STRENGTH',
        'EOC_CODE',
        'EXECUTION_MANAGER_CODE',
        'FISCAL_YEAR',
        'LINE_ITEM_CODE',
        'OCO_OTHD_ADJUSTMENT_K',
        'OCO_OTHD_K',
        'OCO_TO_BASE_K',
        'OSD_PROGRAM_ELEMENT_CODE',
        'POM_POSITION_CODE',
        'POM_SPONSOR_CODE',
        'PROGRAM_CODE',
        'PROGRAM_GROUP',
        'RDTE_PROJECT_CODE',
        'RESOURCE_CATEGORY_CODE',
        'RESOURCE_K',
        'SPECIAL_PROJECT_CODE',
        'SUB_ACTIVITY_GROUP_CODE',
        'SUB_ACTIVITY_GROUP_NAME',
        'WORK_YEARS'
    ],
    'POM': [
            'ASSESSMENT_AREA_CODE',
            'BASE_K',
            'BUDGET_ACTIVITY_NAME',
            'BUDGET_SUB_ACTIVITY_NAME',
            'CAPABILITY_SPONSOR_CODE',
            'EOC_CODE',
            'EXECUTION_MANAGER_CODE',
            'FISCAL_YEAR',
            'OCO_OTHD_K',
            'OCO_TO_BASE_K',
            'OSD_PROGRAM_ELEMENT_CODE',
            'POM_SPONSOR_CODE',
            'PROGRAM_CODE',
            'RESOURCE_CATEGORY_CODE',
            'RESOURCE_K',
            'SPECIAL_PROJECT_CODE',
            'SUB_ACTIVITY_GROUP_CODE',
            'SUB_ACTIVITY_GROUP_NAME'
    ],
    "OUT_OF_POM":[
        'ASSESSMENT_AREA_CODE',
        'POM_SPONSOR_CODE',
        'RESOURCE_CATEGORY_CODE',
        'PROGRAM_CODE',
        'EOC_CODE',
        'SPECIAL_PROJECT_CODE',
        'OSD_PROGRAM_ELEMENT_CODE',
        'BUDGET_ACTIVITY_NAME',
        'SUB_ACTIVITY_GROUP_CODE',
        'SUB_ACTIVITY_GROUP_NAME',
        'BUDGET_SUB_ACTIVITY_NAME',
        'EXECUTION_MANAGER_CODE',
        'CAPABILITY_SPONSOR_CODE',
        'FISCAL_YEAR',
        'RESOURCE_K',
        'BASE_K',
        'OCO_OTHD_K',
        'OCO_TO_BASE_K'
    ],
    'EXTRACT':[
        'ASSESSMENT_AREA_CODE',
        'BUDGET_ACTIVITY_CODE',
        'BUDGET_ACTIVITY_NAME',
        'BUDGET_SUB_ACTIVITY_CODE',
        'BUDGET_SUB_ACTIVITY_NAME',
        'CAPABILITY_SPONSOR_CODE',
        'DELTA_AMT',
        'DELTA_O2B_AMT',
        'DELTA_OCO_AMT',
        'EOC_CODE',
        'EVENT_DATE',
        'EVENT_JUSTIFICATION',
        'EVENT_NAME',
        'EVENT_STATUS',
        'EVENT_STATUS_COMMENT',
        'EVENT_TITLE',
        'EVENT_TYPE',
        'EVENT_USER',
        'EXECUTION_MANAGER_CODE',
        'FISCAL_YEAR',
        'LINE_ITEM_CODE',
        'O2B_AMT',
        'OCO_AMT',
        'OSD_PROGRAM_ELEMENT_CODE',
        'POM_POSITION_CODE',
        'POM_SPONSOR_CODE',
        'PROGRAM_CODE',
        'PROGRAM_GROUP',
        'PROP_AMT',
        'PROP_O2B_AMT',
        'PROP_OCO_AMT',
        'RDTE_PROJECT_CODE',
        'RESOURCE_CATEGORY_CODE',
        'RESOURCE_K',
        'SPECIAL_PROJECT_CODE',
        'SUB_ACTIVITY_GROUP_CODE',
        'SUB_ACTIVITY_GROUP_NAME'     
    ]
}

#PROGRAM_ID + FISCAL YEAR
unique_rows_subset = ['PROGRAM_CODE', 'POM_SPONSOR_CODE','CAPABILITY_SPONSOR_CODE', 'ASSESSMENT_AREA_CODE','EXECUTION_MANAGER_CODE', 'RESOURCE_CATEGORY_CODE', 'EOC_CODE', 'OSD_PROGRAM_ELEMENT_CODE', 'FISCAL_YEAR']
unique_rows_subset_lookup = {
    'EXT':unique_rows_subset,
    'ZBT':unique_rows_subset,
    'ISS':unique_rows_subset,
    'POM':unique_rows_subset,
    'EXTRACT': ["PROGRAM_CODE","POM_SPONSOR_CODE","CAPABILITY_SPONSOR_CODE","ASSESSMENT_AREA_CODE","EXECUTION_MANAGER_CODE","RESOURCE_CATEGORY_CODE","EOC_CODE","OSD_PROGRAM_ELEMENT_CODE","EVENT_NAME","FISCAL_YEAR"]
}

all_cols_list_def = [
    'ADJUSTMENT_K',
    'ASSESSMENT_AREA_CODE',
    'BASE_K',
    'BUDGET_ACTIVITY_CODE',
    'BUDGET_ACTIVITY_NAME',
    'BUDGET_SUB_ACTIVITY_CODE',
    'BUDGET_SUB_ACTIVITY_NAME',
    'CAPABILITY_SPONSOR_CODE',
    'END_STRENGTH',
    'EOC_CODE',
    'EXECUTION_MANAGER_CODE',
    'FISCAL_YEAR',
    'LINE_ITEM_CODE',
    'OCO_OTHD_ADJUSTMENT_K',
    'OCO_OTHD_K',
    'OCO_TO_BASE_K',
    'OSD_PROGRAM_ELEMENT_CODE',
    'POM_POSITION_CODE',
    'POM_SPONSOR_CODE',
    'PROGRAM_CODE',
    'PROGRAM_GROUP',
    'RDTE_PROJECT_CODE',
    'RESOURCE_CATEGORY_CODE',
    'RESOURCE_K',
    'SPECIAL_PROJECT_CODE',
    'SUB_ACTIVITY_GROUP_CODE',
    'SUB_ACTIVITY_GROUP_NAME',
    'WORK_YEARS'
]

all_cols_list_r1 = [
    'EVENT_NAME',
    'EVENT_NUMBER',
    'EVENT_TYPE',
    'EVENT_TITLE',
    'CLASSIFICATION',
    'RESOURCE_CATEGORY_CODE',
    'ASSESSMENT_AREA_CODE',
    'PROGRAM_GROUP',
    'PROGRAM_CODE',
    'EOC_CODE',
    'SPECIAL_PROJECT_CODE',
    'SUB_ACTIVITY_GROUP_CODE',
    'SUB_ACTIVITY_GROUP_NAME',
    'OSD_PROGRAM_ELEMENT_CODE',
    'LINE_ITEM_CODE',
    'RDTE_PROJECT_CODE',
    'EXECUTION_MANAGER_CODE',
    'CAPABILITY_SPONSOR_CODE',
    'RESOURCE_K_FISCAL_YEAR',
    'PROP_AMT_FISCAL_YEAR',
    'DELTA_AMT_FISCAL_YEAR',
    'RESOURCE_K_FISCAL_YEAR',
    'PROP_AMT_FISCAL_YEAR',
    'DELTA_AMT_FISCAL_YEAR',
    'RESOURCE_K_FYDP',
    'PROP_AMT_FYDP',
    'DELTA_AMT_FYDP',
    'OCO_O2B_COMMENT',
    'EVENT_JUSTIFICATION',
    'POM_SPONSOR_CODE',
    'PROGRAM_ID',
]

all_cols_nullable_lookup = defaultdict(lambda: None)

all_cols_nullable_lookup.update({
    'ADJUSTMENT_K':False,
    'FISCAL_YEAR':False,
    'EVENT_NAME':True,
    'EVENT_NUMBER':False,
    'EVENT_TYPE':False,
    'EVENT_TITLE':False,
    'CLASSIFICATION':False,
    'RESOURCE_CATEGORY_CODE':False,
    'ASSESSMENT_AREA_CODE':False,
    'PROGRAM_GROUP':False,
    'PROGRAM_CODE':False,
    'EOC_CODE':False,
    'SPECIAL_PROJECT_CODE':None,
    'SUB_ACTIVITY_GROUP_CODE':True,
    'SUB_ACTIVITY_GROUP_NAME':True,
    'OSD_PROGRAM_ELEMENT_CODE':False,
    'LINE_ITEM_CODE':True,
    'RDTE_PROJECT_CODE':True,
    'EXECUTION_MANAGER_CODE':None,
    'CAPABILITY_SPONSOR_CODE':False,
    'RESOURCE_K_FISCAL_YEAR':False,
    'PROP_AMT_FISCAL_YEAR':None,
    'DELTA_AMT_FISCAL_YEAR':False,
    'RESOURCE_K_FISCAL_YEAR':False,
    'DELTA_AMT_FISCAL_YEAR':False,
    'RESOURCE_K_FYDP':None,
    'PROP_AMT_FYDP':None,
    'DELTA_AMT_FYDP':None,
    'OCO_O2B_COMMENT':True,
    'EVENT_JUSTIFICATION':True,
    'POM_SPONSOR_CODE':False,
    'PROGRAM_ID':False,
})

all_cols_maxlen_lookup = defaultdict(lambda: None)
all_cols_maxlen_lookup.update({
    'EVENT_NAME':60,
    'EVENT_NUMBER':None,
    'EVENT_TYPE':10,
    'EVENT_TITLE':200,
    'CLASSIFICATION':7,
    'RESOURCE_CATEGORY_CODE':8,
    'ASSESSMENT_AREA_CODE':1,
    'PROGRAM_GROUP':24,
    'PROGRAM_CODE':11,
    'EOC_CODE':15,
    'SPECIAL_PROJECT_CODE':None,
    'SUB_ACTIVITY_GROUP_CODE':9,
    'SUB_ACTIVITY_GROUP_NAME':60,
    'OSD_PROGRAM_ELEMENT_CODE':10,
    'LINE_ITEM_CODE':13,
    'RDTE_PROJECT_CODE':9,
    'EXECUTION_MANAGER_CODE':13,
    'CAPABILITY_SPONSOR_CODE':13,
    'RESOURCE_K_FISCAL_YEAR':None,
    'PROP_AMT_FISCAL_YEAR':None,
    'DELTA_AMT_FISCAL_YEAR':None,
    'RESOURCE_K_FISCAL_YEAR':None,
    'DELTA_AMT_FISCAL_YEAR':None,
    'RESOURCE_K_FYDP':None,
    'PROP_AMT_FYDP':None,
    'DELTA_AMT_FYDP':None,
    'OCO_O2B_COMMENT':250,
    'EVENT_JUSTIFICATION':5000,
    'POM_SPONSOR_CODE':13,
    'PROGRAM_ID':60,
})


numeric_cols_lookup = {
    'EVENT_NUMBER':'smallint',
    'SPECIAL_PROJECT_CODE':'smallint',
    'RESOURCE_K_FISCAL_YEAR':'int',
    'PROP_AMT_FISCAL_YEAR':'int',
    'DELTA_AMT_FISCAL_YEAR':'int',
    'RESOURCE_K_FISCAL_YEAR':'int',
    'RESOURCE_K_FYDP':'int',
    'PROP_AMT_FYDP':'int',
    'DELTA_AMT_FYDP':'int',
}