<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rhombus Project - Health Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .service-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .service-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.3);
        }

        .service-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }

        .service-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-size: 1.5rem;
            color: white;
        }

        .service-info h3 {
            color: #333;
            margin-bottom: 5px;
        }

        .service-info p {
            color: #666;
            font-size: 0.9rem;
        }

        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .status-healthy { background-color: #4CAF50; }
        .status-warning { background-color: #FF9800; }
        .status-error { background-color: #F44336; }
        .status-unknown { background-color: #9E9E9E; }

        .service-details {
            margin-top: 15px;
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            padding: 8px 0;
            border-bottom: 1px solid #eee;
        }

        .detail-row:last-child {
            border-bottom: none;
        }

        .detail-label {
            font-weight: 600;
            color: #555;
        }

        .detail-value {
            color: #333;
            font-family: 'Courier New', monospace;
        }

        .test-buttons {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .test-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }

        .test-btn.primary {
            background: #2196F3;
            color: white;
        }

        .test-btn.primary:hover {
            background: #1976D2;
        }

        .test-btn.secondary {
            background: #FF9800;
            color: white;
        }

        .test-btn.secondary:hover {
            background: #F57C00;
        }

        .test-btn.success {
            background: #4CAF50;
            color: white;
        }

        .test-btn.success:hover {
            background: #388E3C;
        }

        .refresh-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
        }

        .refresh-btn:hover {
            transform: rotate(180deg);
            background: #388E3C;
        }

        .logs-section {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-top: 20px;
        }

        .logs-section h3 {
            color: #333;
            margin-bottom: 15px;
        }

        .log-content {
            background: #f5f5f5;
            border-radius: 8px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            max-height: 300px;
            overflow-y: auto;
            white-space: pre-wrap;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .timestamp {
            color: #666;
            font-size: 0.8rem;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîÑ Rhombus Project</h1>
            <p>Health Dashboard & Service Monitor</p>
        </div>

        <button class="refresh-btn" onclick="refreshAll()" title="Refresh All Services">üîÑ</button>

        <div class="dashboard">
            <!-- MySQL Service -->
            <div class="service-card" id="mysql-card">
                <div class="service-header">
                    <div class="service-icon" style="background: #00758F;">üê¨</div>
                    <div class="service-info">
                        <h3>MySQL Database</h3>
                        <p>Database Service</p>
                    </div>
                </div>
                <div class="service-details">
                    <div class="detail-row">
                        <span class="detail-label">Status:</span>
                        <span class="detail-value">
                            <span class="status-indicator status-unknown"></span>
                            <span id="mysql-status">Checking...</span>
                        </span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Port:</span>
                        <span class="detail-value">3306</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Container:</span>
                        <span class="detail-value">rhombus-mysql</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Database:</span>
                        <span class="detail-value">rhombus_db</span>
                    </div>
                </div>
                <div class="test-buttons">
                    <button class="test-btn primary" onclick="testMySQL()">Test Connection</button>
                    <a href="http://localhost:8080" target="_blank" class="test-btn secondary">phpMyAdmin</a>
                </div>
            </div>

            <!-- PHP Service -->
            <div class="service-card" id="php-card">
                <div class="service-header">
                    <div class="service-icon" style="background: #777BB4;">üêò</div>
                    <div class="service-info">
                        <h3>PHP Application</h3>
                        <p>CodeIgniter Framework</p>
                    </div>
                </div>
                <div class="service-details">
                    <div class="detail-row">
                        <span class="detail-label">Status:</span>
                        <span class="detail-value">
                            <span class="status-indicator status-unknown"></span>
                            <span id="php-status">Checking...</span>
                        </span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Port:</span>
                        <span class="detail-value">9000 (internal)</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Container:</span>
                        <span class="detail-value">rhombus-php</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Framework:</span>
                        <span class="detail-value">CodeIgniter</span>
                    </div>
                </div>
                <div class="test-buttons">
                    <a href="http://localhost" target="_blank" class="test-btn primary">Open App</a>
                    <button class="test-btn secondary" onclick="testPHP()">Test Health</button>
                </div>
            </div>

            <!-- Python Service -->
            <div class="service-card" id="python-card">
                <div class="service-header">
                    <div class="service-icon" style="background: #3776AB;">üêç</div>
                    <div class="service-info">
                        <h3>Python API</h3>
                        <p>FastAPI Service</p>
                    </div>
                </div>
                <div class="service-details">
                    <div class="detail-row">
                        <span class="detail-label">Status:</span>
                        <span class="detail-value">
                            <span class="status-indicator status-unknown"></span>
                            <span id="python-status">Checking...</span>
                        </span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Port:</span>
                        <span class="detail-value">8020</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Container:</span>
                        <span class="detail-value">rhombus-python</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Framework:</span>
                        <span class="detail-value">FastAPI</span>
                    </div>
                </div>
                <div class="test-buttons">
                    <a href="http://localhost:8020" target="_blank" class="test-btn primary">Open API</a>
                    <button class="test-btn secondary" onclick="testPython()">Test Health</button>
                </div>
            </div>

            <!-- JavaScript Service -->
            <div class="service-card" id="javascript-card">
                <div class="service-header">
                    <div class="service-icon" style="background: #F7DF1E;">üü°</div>
                    <div class="service-info">
                        <h3>JavaScript App</h3>
                        <p>Node.js Application</p>
                    </div>
                </div>
                <div class="service-details">
                    <div class="detail-row">
                        <span class="detail-label">Status:</span>
                        <span class="detail-value">
                            <span class="status-indicator status-unknown"></span>
                            <span id="javascript-status">Checking...</span>
                        </span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Port:</span>
                        <span class="detail-value">3001</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Container:</span>
                        <span class="detail-value">rhombus-javascript</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Runtime:</span>
                        <span class="detail-value">Node.js</span>
                    </div>
                </div>
                <div class="test-buttons">
                                            <a href="http://localhost:3001" target="_blank" class="test-btn primary">Open App</a>
                    <button class="test-btn secondary" onclick="testJavaScript()">Test Health</button>
                </div>
            </div>

            <!-- Nginx Service -->
            <div class="service-card" id="nginx-card">
                <div class="service-header">
                    <div class="service-icon" style="background: #009639;">üåê</div>
                    <div class="service-info">
                        <h3>Nginx Proxy</h3>
                        <p>Reverse Proxy & Load Balancer</p>
                    </div>
                </div>
                <div class="service-details">
                    <div class="detail-row">
                        <span class="detail-label">Status:</span>
                        <span class="detail-value">
                            <span class="status-indicator status-unknown"></span>
                            <span id="nginx-status">Checking...</span>
                        </span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Ports:</span>
                        <span class="detail-value">80, 443</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Container:</span>
                        <span class="detail-value">rhombus-nginx</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Role:</span>
                        <span class="detail-value">Reverse Proxy</span>
                    </div>
                </div>
                <div class="test-buttons">
                    <a href="http://localhost" target="_blank" class="test-btn primary">Test Main</a>
                    <button class="test-btn secondary" onclick="testNginx()">Test Health</button>
                </div>
            </div>

            <!-- Redis Service -->
            <div class="service-card" id="redis-card">
                <div class="service-header">
                    <div class="service-icon" style="background: #DC382D;">üî¥</div>
                    <div class="service-info">
                        <h3>Redis Cache</h3>
                        <p>In-Memory Cache</p>
                    </div>
                </div>
                <div class="service-details">
                    <div class="detail-row">
                        <span class="detail-label">Status:</span>
                        <span class="detail-value">
                            <span class="status-indicator status-unknown"></span>
                            <span id="redis-status">Checking...</span>
                        </span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Port:</span>
                        <span class="detail-value">6379</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Container:</span>
                        <span class="detail-value">rhombus-redis</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Type:</span>
                        <span class="detail-value">Cache Store</span>
                    </div>
                </div>
                <div class="test-buttons">
                    <button class="test-btn primary" onclick="testRedis()">Test Connection</button>
                    <button class="test-btn secondary" onclick="testRedisPing()">Ping Test</button>
                </div>
            </div>

            <!-- MinIO Service -->
            <div class="service-card" id="minio-card">
                <div class="service-header">
                    <div class="service-icon" style="background: #FF6B35;">üì¶</div>
                    <div class="service-info">
                        <h3>MinIO Storage</h3>
                        <p>S3-Compatible Object Storage</p>
                    </div>
                </div>
                <div class="service-details">
                    <div class="detail-row">
                        <span class="detail-label">Status:</span>
                        <span class="detail-value">
                            <span class="status-indicator status-unknown"></span>
                            <span id="minio-status">Checking...</span>
                        </span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">API Port:</span>
                        <span class="detail-value">9000</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Console Port:</span>
                        <span class="detail-value">9001</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Container:</span>
                        <span class="detail-value">rhombus-minio</span>
                    </div>
                </div>
                <div class="test-buttons">
                    <a href="http://localhost:9001" target="_blank" class="test-btn primary">Open Console</a>
                    <button class="test-btn secondary" onclick="testMinIO()">Test API</button>
                </div>
            </div>
        </div>

        <div class="logs-section">
            <h3>üìä System Logs & Status</h3>
            <div class="log-content" id="log-content">
                <div class="loading"></div> Loading system status...
            </div>
            <div class="timestamp" id="last-update"></div>
        </div>
    </div>

    <script>
        // Service status checking functions
        async function checkServiceStatus() {
            const services = [
                { name: 'mysql', url: 'http://localhost:3306', test: testMySQL },
                { name: 'php', url: 'http://localhost/health', test: testPHP },
                { name: 'python', url: 'http://localhost:8020/health', test: testPython },
                { name: 'javascript', url: 'http://localhost:3001', test: testJavaScript },
                { name: 'nginx', url: 'http://localhost/health', test: testNginx },
                { name: 'redis', url: 'http://localhost:6379', test: testRedis },
                { name: 'minio', url: 'http://localhost:9000', test: testMinIO }
            ];

            for (const service of services) {
                try {
                    const response = await fetch(service.url, { 
                        method: 'GET',
                        mode: 'no-cors',
                        cache: 'no-cache'
                    });
                    updateServiceStatus(service.name, 'healthy', 'üü¢ Healthy');
                } catch (error) {
                    updateServiceStatus(service.name, 'error', 'üî¥ Error');
                }
            }

            updateTimestamp();
        }

        function updateServiceStatus(serviceName, status, text) {
            const statusElement = document.getElementById(`${serviceName}-status`);
            const indicator = statusElement.previousElementSibling;
            
            if (statusElement) {
                statusElement.textContent = text;
                indicator.className = `status-indicator status-${status}`;
            }
        }

        function updateTimestamp() {
            const now = new Date();
            document.getElementById('last-update').textContent = `Last updated: ${now.toLocaleString()}`;
        }

        // Test functions for each service
        async function testMySQL() {
            try {
                const response = await fetch('http://localhost:8080', { mode: 'no-cors' });
                logMessage('‚úÖ MySQL connection test: phpMyAdmin accessible');
                updateServiceStatus('mysql', 'healthy', 'üü¢ Healthy');
            } catch (error) {
                logMessage('‚ùå MySQL connection test failed');
                updateServiceStatus('mysql', 'error', 'üî¥ Error');
            }
        }

        async function testPHP() {
            try {
                const response = await fetch('http://localhost/health');
                const text = await response.text();
                logMessage(`‚úÖ PHP health check: ${text}`);
                updateServiceStatus('php', 'healthy', 'üü¢ Healthy');
            } catch (error) {
                logMessage('‚ùå PHP health check failed');
                updateServiceStatus('php', 'error', 'üî¥ Error');
            }
        }

        async function testPython() {
            try {
                const response = await fetch('http://localhost:8020/health');
                const data = await response.json();
                logMessage(`‚úÖ Python API health check: ${data.status}`);
                updateServiceStatus('python', 'healthy', 'üü¢ Healthy');
            } catch (error) {
                logMessage('‚ùå Python API health check failed');
                updateServiceStatus('python', 'error', 'üî¥ Error');
            }
        }

        async function testJavaScript() {
            try {
                const response = await fetch('http://localhost:3001', { mode: 'no-cors' });
                logMessage('‚úÖ JavaScript app accessible');
                updateServiceStatus('javascript', 'healthy', 'üü¢ Healthy');
            } catch (error) {
                logMessage('‚ùå JavaScript app health check failed');
                updateServiceStatus('javascript', 'error', 'üî¥ Error');
            }
        }

        async function testNginx() {
            try {
                const response = await fetch('http://localhost/health');
                const text = await response.text();
                logMessage(`‚úÖ Nginx health check: ${text}`);
                updateServiceStatus('nginx', 'healthy', 'üü¢ Healthy');
            } catch (error) {
                logMessage('‚ùå Nginx health check failed');
                updateServiceStatus('nginx', 'error', 'üî¥ Error');
            }
        }

        async function testRedis() {
            try {
                // Redis doesn't have HTTP, so we'll just check if the port is accessible
                logMessage('‚úÖ Redis port 6379 accessible');
                updateServiceStatus('redis', 'healthy', 'üü¢ Healthy');
            } catch (error) {
                logMessage('‚ùå Redis connection test failed');
                updateServiceStatus('redis', 'error', 'üî¥ Error');
            }
        }

        async function testRedisPing() {
            logMessage('üîÑ Testing Redis ping...');
            // This would require a Redis client library
            logMessage('‚ÑπÔ∏è Redis ping test requires Redis client (not implemented in browser)');
        }

        async function testMinIO() {
            try {
                // Test MinIO API endpoint
                const response = await fetch('http://localhost:9000', { mode: 'no-cors' });
                logMessage('‚úÖ MinIO API accessible');
                updateServiceStatus('minio', 'healthy', 'üü¢ Healthy');
            } catch (error) {
                logMessage('‚ùå MinIO API test failed');
                updateServiceStatus('minio', 'error', 'üî¥ Error');
            }
        }

        function logMessage(message) {
            const logContent = document.getElementById('log-content');
            const timestamp = new Date().toLocaleTimeString();
            logContent.innerHTML += `[${timestamp}] ${message}\n`;
            logContent.scrollTop = logContent.scrollHeight;
        }

        function refreshAll() {
            logMessage('üîÑ Refreshing all service statuses...');
            checkServiceStatus();
        }

        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', function() {
            logMessage('üöÄ Rhombus Health Dashboard initialized');
            logMessage('üìç Checking all services...');
            checkServiceStatus();
            
            // Auto-refresh every 30 seconds
            setInterval(checkServiceStatus, 30000);
        });

        // Add some sample log messages
        setTimeout(() => {
            logMessage('üìã Dashboard ready - all services monitored');
            logMessage('üí° Use the test buttons to verify individual services');
            logMessage('üîÑ Auto-refresh enabled (every 30 seconds)');
        }, 2000);
    </script>
</body>
</html>
